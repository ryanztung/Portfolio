# Stock Price Forecasting

In this project, I perform time series forecasting on 15 years of AAPL stock to predict market close prices at sub 1.2% average validation error. The project deploys two separate LSTM networks to make predictions, one with 30 sequential featueres, and another with 36 sequential and static features. I then deploy my model in a web-based API that allows users to visualize and predict the close price of any future date.

## Project Structure

- **app/**: Contains the Flask application for the model API.
  - `main.py`: The Flask application's main file that handles requests and predictions.
  - `static/`: Contains CSS for the web interface and stores prediction plots generated by the Flask application.
  - `templates/`: Contains the HTML template for the web interface.

- **models/**: Contains the saved models.
  - `date_scaler.pkl`: The fitted MinMaxScaler used to scale day, month, and year features from 0 to 1.
  - `price_scaler.pkl`: The fitted MinMaxScaler used to scale close prices from 0 to 1.
  - `functional_LSTM.keras`: The LSTM model trained using Keras' Functional API that takes both sequential and static features as input.
  - `sequential_LSTM.keras`: The LSTM model trained using Keras' Sequential API that takes only sequential features as input.

- **notebooks/**: Contains Jupyter notebooks for data pre-processing, feature engineering, and model training.
  - `exploratory_data_analysis.ipynb`: Notebook for time series visualization and decomposition.
  - `feature_engineering.ipynb`: Notebook for generating rolling and window features in an LSTM-compatible format.
  - `modeling.ipynb`: Notebook for training and evaluating both LSTM models.

- **data/**: Contains all data files.
  - `dates.npy`: Contains a vector of all dates corresponding to the dataset.
  - `X.npy`: Contains the feature matrix of sequential features.
  - `X_static.npy`: Contains the feature matrix of sequential features.
  - `y.npy`: Contains the target vector of scaled close prices.
  - `stock_data.csv`: Contains the full dataset in CSV format.

- **requirements.txt**: List of Python dependencies.
  
- **README.md**: Project overview.

- **LICENSE**: Project license.

## Setup Instructions

### Prerequisites

- Python 3.7+
- pip

### Installation

1. **Install dependencies:**
   ```sh
   cd 'Stock Price Forecasting'
   pip install r requirements.txt
   ```

2. **Run the Flask application:**
   ```sh
   python app/main.py
   ```

## Usage

1. **Input prediction date:**
    Input prediction date into field.

2. **Predict outcome:**
    Click the "Predict" button to obtain the close price prediction and visualization.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) for details.